---
description: https://tryhackme.com/room/enterprise
---

# Enterprise

## Nmap

```python
sudo nmap 10.10.103.17 -p- -sS -sV -PA

PORT      STATE    SERVICE       VERSION
53/tcp    filtered domain
80/tcp    open     http          Microsoft IIS httpd 10.0
88/tcp    open     kerberos-sec  Microsoft Windows Kerberos (server time: 2021-10-24 07:41:39Z)
135/tcp   open     msrpc         Microsoft Windows RPC
139/tcp   open     netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open     ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)
445/tcp   open     microsoft-ds?
464/tcp   open     kpasswd5?
593/tcp   open     ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open     tcpwrapped
3268/tcp  open     ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)
3269/tcp  open     tcpwrapped
3389/tcp  open     ms-wbt-server Microsoft Terminal Services
5357/tcp  open     http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
5985/tcp  open     http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
7990/tcp  open     http          Microsoft IIS httpd 10.0
9389/tcp  open     mc-nmf        .NET Message Framing
47001/tcp open     http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49664/tcp open     msrpc         Microsoft Windows RPC
49665/tcp open     msrpc         Microsoft Windows RPC
49666/tcp open     msrpc         Microsoft Windows RPC
49668/tcp open     msrpc         Microsoft Windows RPC
49669/tcp open     ncacn_http    Microsoft Windows RPC over HTTP 1.0
49671/tcp open     msrpc         Microsoft Windows RPC
49672/tcp open     msrpc         Microsoft Windows RPC
49674/tcp open     msrpc         Microsoft Windows RPC
49702/tcp open     msrpc         Microsoft Windows RPC
49707/tcp open     msrpc         Microsoft Windows RPC
Service Info: Host: LAB-DC; OS: Windows; CPE: cpe:/o:microsoft:windows
```

Initial enumeration on SMB with `crackmapexec` using anonymous credentials shows the following discovered users through  rid bruteforcing.

```python
crackmapexec smb 10.10.103.17  -u 'a' -p '' --users --rid-brute | grep '(SidTypeUser)' 
```

![](<.gitbook/assets/Enterpirse - SMB users.png>)

From above we now have the following known user accounts.

```
atlbitbucket
bitbucket
nik
spooks
korone
banana
cake
contractor-temp
varg
joiner
```

As well as non default groups

```python
crackmapexec smb 10.10.103.17  -u 'a' -p '' --users --rid-brute | grep '(SidTypeGroup)' 
```

![](<.gitbook/assets/Enterprise - SMB Groups.png>)

```
Password-Policy-Exemption
Contractor
sensitive-account
adobe-subscription
```

Checking listed shares with an anonymous login&#x20;

```python
smbclient -U 'a' -L \\\\10.10.103.17\\
```

