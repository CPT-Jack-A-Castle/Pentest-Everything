---
description: https://attack.mitre.org/techniques/T1134/005/
---

# ðŸ”¨ SID-History Injection

### T1134.005: Make and Impersonate Token

**Permissions Required: **<mark style="color:red;">**Administrator**</mark>** | **<mark style="color:red;">**SYSTEM**</mark>

**Description**

Adversaries may use SID-History Injection to escalate privileges and bypass access controls. The Windows security identifier (SID) is a unique value that identifies a user or group account. SIDs are used by Windows security in both security descriptors and access tokens. An account can hold additional SIDs in the SID-History Active Directory attribute, allowing inter-operable account migration between domains (e.g., all values in SID-History are included in access tokens).

With Domain Administrator (or equivalent) rights, harvested or well-known SID values may be inserted into SID-History to enable impersonation of arbitrary users/groups such as Enterprise Administrators. This manipulation may result in elevated access to local resources and/or access to otherwise inaccessible domains via lateral movement techniques such as Remote Services, SMB/Windows Admin Shares, or Windows Remote Management.

[\[Source\]](https://attack.mitre.org/techniques/T1134/005/)

## Techniques

### Empire

```
powershell/persistence/misc/add_sid_history
```

### Mimikatz

```powershell
Invoke-Mimikatz -Command '"sid::patch" "sid::add /sid: /sam:"'
```

## Mitigation

## Further Reading

**Windows Security Identifier (SID) History Injection Exposure:** [https://www.attivonetworks.com/blogs/windows-sid-history-injection-exposure-blog/](https://www.attivonetworks.com/blogs/windows-sid-history-injection-exposure-blog/)
